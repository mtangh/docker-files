# container

# docker container env
docker-container-env() {
  unset DOCKER_CONTAINER DOCKER_IMAGE_TAG
  [ -r "$(pwd)/Dockerfile" ] &&
  [ -n "$(type -P _docker-get-opts-from-dockerfile.sh)" ] && {
    $DOCKER_BIN_DIR/_docker-get-opts-from-dockerfile.sh "$(pwd)/Dockerfile"
  }
  return $?
}

# container id
get-container-id() {
  local _container=""
  unset DOCKER_CONTAINER DOCKER_IMAGE_TAG
  eval $(docker-container-env)
  for _container in \
    "$DOCKER_CONTAINER" \
    "$DOCKER_IMAGE_TAG"
  do
    [ -n "$_container" ] &&
    ${DOCKER_BIN_DIR}/_docker-get-container-id.sh "$_container" $@ |
    sort |head -n 1 && return 0
  done
  ${DOCKER_BIN_DIR}/_docker-get-container-id.sh $@
  return $?
}

# container id
get-container-id-all() {
  get-container-id --all $@
  return $?
}

# container id
get-container-port() {
  local _container=$(get-container-id)
  if [ -n "$_container" ]
  then
    ${DOCKER_BIN_DIR}/_docker-get-container-port.sh -id "$_container" $@
  else
    ${DOCKER_BIN_DIR}/_docker-get-container-port.sh $@
  fi
  return $?
}

